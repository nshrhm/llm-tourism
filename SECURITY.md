# セキュリティポリシー

LLM地域観光紹介性能比較実験プロジェクトのセキュリティポリシーと脆弱性報告手順。

## サポートされているバージョン

現在セキュリティアップデートが提供されているバージョン：

| バージョン | サポート状況 |
| ------- | ------------ |
| 1.0.x   | :white_check_mark: サポート中 |
| < 1.0   | :x: サポート終了 |

## セキュリティ原則

本プロジェクトは学術研究用オープンソースソフトウェアとして、以下のセキュリティ原則を遵守します：

### 1. データ保護

- **APIキーの保護**: 環境変数（`.env`）によるAPIキー管理
- **実験データの保護**: `.gitignore`による生データの自動除外
- **個人情報**: 実験データに個人を特定できる情報を含めない

### 2. 依存関係の管理

- **定期的な更新**: 依存パッケージのセキュリティアップデートを適用
- **脆弱性スキャン**: `pip-audit`などのツールによる定期チェック
- **最小権限の原則**: 必要最小限のパッケージのみをインストール

### 3. コード品質

- **コードレビュー**: すべてのPull Requestにレビューを実施
- **自動テスト**: セキュリティに関連するテストを含む
- **静的解析**: Lintツールによるコード品質チェック

## 既知のセキュリティ制約

### APIキーの取り扱い

**重要**: 本プロジェクトは`.env`ファイルでAPIキーを管理します。

**リスク**:
- `.env`ファイルがコミットされる可能性
- ログファイルにAPIキーが出力される可能性

**対策**:
- `.gitignore`で`.env`を除外（設定済み）
- `.env.example`でテンプレート提供
- ログ出力時にAPIキーをマスク
- コミット前にAPIキーが含まれていないか確認

### 実験データの機密性

**重要**: 生成されたテキストデータに機密情報が含まれる可能性があります。

**推奨事項**:
- 実験データを公開リポジトリにコミットしない
- データ共有時は内容を確認
- 必要に応じてデータを匿名化

## 脆弱性の報告

セキュリティ上の脆弱性を発見した場合は、以下の手順で報告してください。

### 報告方法

**公開Issueでの報告は避けてください。** セキュリティ上の脆弱性は、悪用を防ぐため非公開で報告してください。

#### 推奨される報告方法

1. **GitHub Security Advisory** (推奨)
   - リポジトリの "Security" タブから "Report a vulnerability" を選択
   - 脆弱性の詳細を記載

2. **メールによる報告**
   - 宛先: `[メンテナーのメールアドレス]`
   - 件名: `[SECURITY] LLM Tourism Project Vulnerability Report`

### 報告に含めるべき情報

脆弱性報告には、以下の情報を含めてください：

1. **脆弱性の種類**
   - 該当するCWE（Common Weakness Enumeration）番号
   - OWASP Top 10カテゴリ（該当する場合）

2. **影響を受けるバージョン**
   - プロジェクトのバージョン
   - Pythonバージョン
   - OS環境

3. **脆弱性の詳細**
   - 脆弱性の説明
   - 再現手順
   - 影響範囲（CIA: 機密性、完全性、可用性）

4. **概念実証（PoC）**
   - 再現可能なコード例
   - 環境設定

5. **提案される修正方法**
   - 修正案（あれば）
   - 参考資料

### 報告後の流れ

1. **受領確認**: 48時間以内に受領を確認
2. **初期評価**: 1週間以内に脆弱性を評価
3. **修正計画**: 重大度に応じて修正計画を策定
4. **パッチ開発**: 修正パッチを開発
5. **公開**: 修正完了後、適切なタイミングで公開

### 重大度の評価

脆弱性の重大度は、CVSSv3.1に基づいて評価します：

| 重大度 | CVSSスコア | 対応時間 |
|--------|-----------|---------|
| Critical | 9.0-10.0 | 24時間以内 |
| High | 7.0-8.9 | 1週間以内 |
| Medium | 4.0-6.9 | 1ヶ月以内 |
| Low | 0.1-3.9 | 次回リリース |

## よくあるセキュリティ質問

### Q1: APIキーが漏洩した場合はどうすればよいですか？

**A**: 以下の手順で対処してください：

1. **即座にAPIキーを無効化**
   - OpenRouterダッシュボードでAPIキーを削除
   - 新しいAPIキーを生成

2. **影響範囲の確認**
   - 不正使用がないか確認
   - 使用ログをチェック

3. **新しいAPIキーの設定**
   - `.env`ファイルを更新
   - システムを再起動

4. **再発防止**
   - `.gitignore`が正しく設定されているか確認
   - コミット履歴にAPIキーが含まれていないか確認

### Q2: 実験データに機密情報が含まれていた場合は？

**A**: 以下の手順で対処してください：

1. **データの削除**
   - ローカルファイルを削除
   - GitHubにプッシュしていた場合は履歴から削除

2. **影響範囲の確認**
   - データが共有されていないか確認
   - 公開されたデータを削除

3. **再発防止**
   - データ生成プロセスを見直す
   - 機密情報フィルタリングの実装を検討

### Q3: 依存パッケージに脆弱性が見つかった場合は？

**A**: 以下の手順で対処してください：

1. **脆弱性の評価**
   ```bash
   pip-audit
   ```

2. **パッケージの更新**
   ```bash
   pip install --upgrade [パッケージ名]
   pip freeze > requirements.txt
   ```

3. **テストの実行**
   ```bash
   pytest tests/ -v
   ```

4. **変更のコミット**
   ```bash
   git add requirements.txt
   git commit -m "security: update [パッケージ名] to fix vulnerability"
   ```

## セキュリティベストプラクティス

### 開発者向け

1. **APIキーの取り扱い**
   - `.env`ファイルを絶対にコミットしない
   - `.env.example`をテンプレートとして使用
   - APIキーをコードに直接記述しない

2. **依存関係の管理**
   ```bash
   # 定期的に脆弱性をチェック
   pip-audit

   # パッケージを最新版に更新
   pip list --outdated
   pip install --upgrade [パッケージ名]
   ```

3. **コミット前のチェック**
   ```bash
   # 機密情報が含まれていないか確認
   git diff --staged

   # .gitignoreが正しく動作しているか確認
   git status --ignored
   ```

### ユーザー向け

1. **APIキーの保護**
   - APIキーを他人と共有しない
   - APIキー使用量を定期的に確認
   - 不要になったAPIキーは削除

2. **実験データの管理**
   - 生データを公開リポジトリにコミットしない
   - データ共有時は内容を確認
   - 不要なデータは削除

3. **環境の最新化**
   ```bash
   # 定期的にパッケージを更新
   pip install --upgrade -r requirements.txt

   # Pythonも最新の安定版を使用
   python --version
   ```

## セキュリティ更新の通知

セキュリティアップデートは以下の方法で通知されます：

1. **GitHubリリースノート**: 重大なセキュリティ修正を記載
2. **CHANGELOG.md**: すべてのセキュリティ関連の変更を記録
3. **GitHub Security Advisory**: 脆弱性の詳細情報を公開

## 謝辞

セキュリティ脆弱性を報告していただいた方には、以下の形で謝辞を表します（希望する場合）：

- CHANGELOG.mdへの記載
- セキュリティアドバイザリでの謝辞
- CONTRIBUTORS.mdへの記載

## 参考資料

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE - Common Weakness Enumeration](https://cwe.mitre.org/)
- [CVSSv3.1 Calculator](https://www.first.org/cvss/calculator/3.1)
- [GitHub Security Advisories](https://docs.github.com/en/code-security/security-advisories)

## ライセンス

このセキュリティポリシーは、プロジェクト本体と同じ [CC BY 4.0](LICENSE) ライセンスの下で提供されます。

---

**最終更新**: 2025-01-21
**バージョン**: 1.0.0

セキュリティに関する質問や懸念がある場合は、遠慮なくご連絡ください。
